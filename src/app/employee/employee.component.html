<app-sidebar>
  <!-- main content -->
  <div class="tab-content mt-3" id="myTabContent">
    <!-- positions table -->
    <div class="tab-pane fade show active" id="employees">
      <div class="mb-3 float-right">
        <div class="btn-group mr-2">
          <form class="form-inline my-2 my-lg-0 justify-content-center">
            <input name="searchTerm" #searchInput="ngModel" class="form-control mr-sm-2" ngModel (ngModelChange)="search(searchInput.value)"
                   type="search" placeholder="Search employees...">
          </form>
          <button  type="button" class="btn btn-info" data-toggle="modal" data-target="#addPositionModal"><i class="fa fa-plus"></i>&nbsp;New Employee</button>
        </div>
        <div class="btn-group">
          <button type="button" class="btn btn-info" (click)="getEmployees(true)">
            <i class="fas fa-sync fa-spin" *ngIf="refreshing"></i><i class="fas fa-sync" *ngIf="!refreshing"></i>
          </button>
        </div>
      </div>
      <table class="table table-hover">
        <thead class="table-borderless">
        <tr class="text-center">
          <th>First name</th>
          <th>Last name</th>
          <th>Middle name</th>
          <th>Phone number</th>
          <th>Email</th>
          <th>Head</th>
          <th>Department</th>
        </tr>
        </thead>
        <tbody *ngFor="let employee of employees">
        <tr class="text-center">
          <td (click)="setSelectedEmployee(employee)">{{employee?.firstName}}</td>
          <td (click)="setSelectedEmployee(employee)">{{employee?.lastName}}</td>
          <td (click)="setSelectedEmployee(employee)">{{employee?.middleName}}</td>
          <td (click)="setSelectedEmployee(employee)">{{employee?.phoneNumber}}</td>
          <td (click)="setSelectedEmployee(employee)">{{employee?.email}}</td>
          <td (click)="setSelectedEmployee(employee)"><input name="head" type="checkbox" disabled [(ngModel)]="employee.head" class="form-check-input"></td>
          <td (click)="setSelectedEmployee(employee)">{{employeeDepartmentMap.get(employee)?.name}}</td>
          <td>
            <div class="btn-group">
              <button class="btn btn-outline-info" (click)="setEmployeeToUpdate(employee)"><i class="fas fa-edit"></i></button>
              <button class="btn btn-outline-danger" id="-delete-btn" data-toggle="modal" data-target="#deleteEmployeeModal"
                      (click)="setEmployeeToDelete(employee)"><i class="fas fa-trash"></i></button>
            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <button [hidden]="true" type="button" id="open-employee-info-btn" data-toggle="modal" data-target="#viewEmployeeModal"></button>
  <button [hidden]="true" type="button" id="open-employee-update-btn" data-toggle="modal" data-target="#updateEmployeeModal"></button>

  <!--    modal delete user-->
  <div class="modal fade" id="deleteEmployeeModal" tabindex="-1" role="dialog" aria-labelledby="deleteModelLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteModelLabel">Delete User</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="close-employee-delete-modal">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete employee: {{employeeToDelete?.firstName}} {{employeeToDelete?.lastName}}?</p>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
            <button (click)="onDeleteEmployee(employeeToDelete.id)" class="btn btn-danger" data-bs-dismiss="modal">Yes</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- modal user info -->
  <div class="modal fade bd-example-modal-lg" id="viewEmployeeModal" tabindex="-1" role="dialog" aria-labelledby=""
       aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title text-center" id="exampleModalLongTitle">Employee info</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div>
            <div class="card">
                  <div class="col d-flex flex-column flex-sm-row justify-content-between">
                    <div class="text-center text-sm-left mb-sm-0">
                      <h6 class="pt-sm-2 pb-1 mb-0 text-nowrap"></h6>
                      <h2 class="mb-1">{{employeeSelected?.lastName}} {{employeeSelected?.firstName}} {{employeeSelected?.middleName}}&nbsp;<span [hidden]="!employeeSelected?.head" class="badge badge-success float-right">Head</span></h2>
                    </div>
                  </div>
              <ul class="list-group list-group-flush">
                <li class="list-group-item"></li>
                <li class="list-group-item"><i class="fa fa-address-card float-right"></i><b>ID:</b>  {{employeeSelected?.id}}</li>
                <li class="list-group-item"><i class="fa fa-envelope float-right"></i><b>E-Mail:</b> {{employeeSelected?.email}}</li>
                <li class="list-group-item"><i class="fa fa-phone float-right"></i><b>Phone:</b> {{employeeSelected?.phoneNumber}}</li>
                <li class="list-group-item"><i class="fa fa-credit-card float-right"></i><b>Salary:</b>  {{employeeSelected?.salary}} </li>
                <li class="list-group-item"><i class="fa fa-calendar-check float-right"></i><b>Hire date:</b>  {{employeeSelected?.hireDate | date: 'dd.MM.yyyy'}}</li>
                <li class="list-group-item"><i class="fa fa-calendar float-right"></i><b>Dismissal date:</b>  {{employeeSelected?.dismissalDate | date: 'dd.MM.yyyy'}}</li>
                <li class="list-group-item"><i class="fa fa-building float-right"></i><b>Department:</b>  {{employeeDepartmentMap.get(employeeSelected)?.name}}</li>
                <li class="list-group-item"><i class="fa fa-sitemap float-right"></i><b>Position:</b> {{employeePositionMap.get(employeeSelected)?.name}}</li>
                <li class="list-group-item"><i class="fa fa-users float-right"></i><b>User:</b> {{employeeUserMap.get(employeeSelected)?.username}}</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

</app-sidebar>
